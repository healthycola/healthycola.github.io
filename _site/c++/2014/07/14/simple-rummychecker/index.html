<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Simple RummyChecker</title>
    <meta name="viewport" content="width=device-width">
    <meta name="description" content="A small space for a newbie dev. Small and silly projects are always ongoing. Enjoy!">
    <link rel="canonical" href="http://yourdomain.com/c++/2014/07/14/simple-rummychecker/">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/main.css">

</head>


    <body>

    <header class="site-header">

  <div class="wrap">

    <a class="site-title" href="/">Code, Bagels and Gibberish</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
           viewBox="0 0 18 15" enable-background="new 0 0 18 15" xml:space="preserve">
          <path fill="#505050" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0
            h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#505050" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484
            h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#505050" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0
            c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>
      <div class="trigger">
        
          <a class="page-link" href="/about/">About</a>
        
          
        
          
        
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrap">
      <div class="post">

  <header class="post-header">
    <h1>Simple RummyChecker</h1>
    <p class="meta">Jul 14, 2014</p>
  </header>

  <article class="post-content">
  This is a build up on the BlackJack Checker. The Rummy Checker challenge is also from Reddit and can be found <a href="http://www.reddit.com/r/dailyprogrammer/comments/2a9u0a/792014_challenge_170_intermediate_rummy_checker/">here</a>. I think it's more organized than the blackjack checker and less hacky (except for the Run checker function - this function is soooo messy. I need to fix it, urgh).</p>

Major things I'm happy about:</p>
<ul>
<li>Simple tokenizer - It's just good to have this code. I think it's reusable.</li>
<li>Decent organization - A Card class and a Hand class was created. I think the organization is decent, not amazing, but it's getting there.</li>
</ul>

Areas I need to improve on:</p>
<ul>
<li>Rummy Run Detector - At the moment it's really brute-forcy. Gotta think of a better idea to go about it.</li>
<li>Separation - Could use better separation between input and output areas of the program, just for good coding practice.</li>
</ul>

<!--more--></p>

[code language="cpp"]
#include &lt;iostream&gt;
#include &lt;vector&gt;
#include &lt;algorithm&gt;
#include &lt;string&gt;</p>

using namespace std;
int RunLength = 3;
int SetLength = 3;</p>

enum Suite
{
    Spades, Hearts, Clubs, Diamonds, Unknown
};</p>

static const vector&lt;string&gt; tokenizeStrings(string input, string delimiter, int NumberOfSpacesAfterDelimiter)
{
    vector&lt;string&gt; output;
    size_t start;
    size_t found = -1 - NumberOfSpacesAfterDelimiter;  //Two because of spaces after delimiter
    string temp;
    do {
        start = found + 1 + NumberOfSpacesAfterDelimiter;  //Two because of spaces
        found = input.find_first_of(delimiter, start);
        temp = input.substr(start, found - start);
        output.push_back(temp);
    } while(found != string::npos);
    return output;
}</p>

struct Card
{
    Suite m_suite;
    int m_value;</p>

    static const string CardValues[13];
    static const string CardSuits[4];
    static const int ConvertCardValueToInt(string Card)
    {
        int output = 0;
        if (Card == &quot;ace&quot;){
            output = 1;
        }
        else if (Card == &quot;king&quot;){
            output = 13;
        }
        else if (Card == &quot;queen&quot;){
            output = 12;
        }
        else if (Card == &quot;jack&quot;){
            output = 11;
        }
        else if (Card == &quot;ten&quot;){
            output = 10;
        }
        else if (Card == &quot;nine&quot;){
            output = 9;
        }
        else if (Card == &quot;eight&quot;){
            output = 8;
        }
        else if (Card == &quot;seven&quot;){
            output = 7;
        }
        else if (Card == &quot;six&quot;){
            output = 6;
        }
        else if (Card == &quot;five&quot;){
            output = 5;
        }
        else if (Card == &quot;four&quot;){
            output = 4;
        }
        else if (Card == &quot;three&quot;){
            output = 3;
        }
        else if (Card == &quot;two&quot;){
            output = 2;
        }
        else
        {
            output = 0;
        }
        return output;
    }</p>

    static const string ConvertIntToCardValue(int Val)
    {
        if (Val &gt; 0 &amp;&amp; Val &lt;= 13)
            return CardValues[Val - 1];</p>

        return &quot;&quot;;
    }</p>

    static const Suite ConvertCardStringToSuite(string input)
    {
        Suite s = Unknown;
        if (input == &quot;spades&quot;)
            s = Spades;
        else if (input == &quot;hearts&quot;)
            s = Hearts;
        else if (input == &quot;clubs&quot;)
            s = Clubs;
        else if (input == &quot;diamonds&quot;)
            s = Diamonds;</p>

        return s;
    }</p>

    static const string ConvertCardSuitToString(Suite input)
    {
        if (input &gt;= 0 &amp;&amp; input &lt;= 3)
            return CardSuits[input];</p>

        return &quot;&quot;;
    }</p>

    Card(string CardInput)
    {
        //Accepts inputs such as Ace of Diamonds
        vector&lt;string&gt; temp = tokenizeStrings(CardInput, &quot; &quot;, 0);
        m_value = ConvertCardValueToInt(temp[0]);
        m_suite = ConvertCardStringToSuite(temp[2]);
    }
};</p>

const string Card::CardValues[13] = { &quot;ace&quot;, &quot;two&quot;, &quot;three&quot;, &quot;four&quot;, &quot;five&quot;, &quot;six&quot;, &quot;seven&quot;, &quot;eight&quot;, &quot;nine&quot;, &quot;ten&quot;, &quot;jack&quot;, &quot;queen&quot;, &quot;king&quot; };
const string Card::CardSuits[4] = { &quot;spades&quot;, &quot;hearts&quot;, &quot;clubs&quot;, &quot;diamonds&quot; };</p>

template &lt;class T&gt;
void deletePtr(T* ptr)
{
    delete ptr;
}</p>

struct Hand
{
    vector&lt;Card*&gt; m_hand;
    void AddCard(Card *card)
    {
        m_hand.push_back(card);
    }</p>

    void cleanUp()
    {
        for_each(m_hand.begin(), m_hand.end(), deletePtr&lt;Card&gt;);
    }</p>

    static bool sorter(Card* i, Card* j)
    {
        if (i-&gt;m_suite != j-&gt;m_suite)
            return (int)(i-&gt;m_suite) &lt; (int)(j-&gt;m_suite);
        else
            return i-&gt;m_value &lt; j-&gt;m_value;
    }</p>

    void sortHand()
    {
        sort(m_hand.begin(), m_hand.end(), Hand::sorter);
    }</p>

    Card* CheckForSet(Card _card)
    {
        int NewSet = _card.m_value;
        int NumberOfCardsForSet = 1;
        for (vector&lt;Card*&gt;::iterator card = m_hand.begin(); card != m_hand.end(); card++)
        {
            if ((*card)-&gt;m_value == NewSet)
                NumberOfCardsForSet++;
        }
        if (NumberOfCardsForSet &gt;= SetLength)
        {
            // Means we have a set
            for (vector&lt;Card*&gt;::iterator card = m_hand.begin(); card != m_hand.end(); card++)
            {
                if ((*card)-&gt;m_value != NewSet)
                    return *card;
            }
        }
        return nullptr;
    }</p>

    Card* CheckForRun(Card _card)
    {
        //Messy as hell
        vector&lt;Card*&gt; Run;
        bool isRun = false;
        for (vector&lt;Card*&gt;::iterator card = m_hand.begin(); card != m_hand.end(); card++)
        {
            isRun = false;
            if ((*card)-&gt;m_suite != _card.m_suite)
            {
                continue;
            }</p>

            Run.clear();
            Run.push_back(&amp;_card);
            for (vector&lt;Card*&gt;::iterator card_set = card; card_set != m_hand.end(); card_set++)
            {
                if (Run.size() &gt;= RunLength || (*card_set)-&gt;m_suite != _card.m_suite)
                    break;
                Run.push_back((*card_set));
            }</p>

            if (Run.size() &lt; RunLength)
            {
                //No runs possible
                isRun = false;
                break;
            }</p>

            sort(Run.begin(), Run.end(), sorter);
            if ((*(Run.end()-1))-&gt;m_value - (*(Run.begin()))-&gt;m_value == RunLength - 1)
                isRun = true;</p>

            //Found a Run?
            if (isRun)
            {
                vector&lt;Card*&gt;::iterator cardReturn = m_hand.begin();
                for (; cardReturn != m_hand.end(); cardReturn++)
                {
                    bool foundCardReturn = true;
                    for (vector&lt;Card*&gt;::iterator set_check = Run.begin(); set_check != Run.end() - 1; set_check++)
                    {
                        //CHeck if current cardReturn is in the Run.
                        if (*set_check == &amp;_card)
                            continue;</p>

                        if (*cardReturn == *set_check)
                        {
                            // The card we want to return can't be in the set
                            foundCardReturn = false;
                            break;
                        }
                    }
                    if (foundCardReturn)
                    {
                        return *cardReturn;
                    }
                }
                break;
            }
        }</p>

        return nullptr;
    }
};</p>

void outputWin(Card* card)
{
    if (card)
    {
        cout &lt;&lt; &quot;Swap the new card with &quot; &lt;&lt; Card::ConvertIntToCardValue(card-&gt;m_value) &lt;&lt; &quot; of &quot; &lt;&lt; Card::ConvertCardSuitToString(card-&gt;m_suite) &lt;&lt; &quot; to win!\n&quot;;
    }
    else
    {
        printf(&quot;No possible winning hand.\n&quot;);
    }</p>

}</p>

int main(int argc, char** argv)
{
    //string sampleString = &quot;Two of Diamonds, Three of Diamonds, Four of Diamonds, Seven of Diamonds, Seven of Clubs, Seven of Hearts, Jack of Hearts&quot;;
    //string newCard = &quot;Five of Diamonds&quot;;</p>

    string sampleString, newCard;
    cout &lt;&lt; &quot;What is the initial hand?: &quot;;
    getline(cin, sampleString);
    cout &lt;&lt; &quot;What is the added hand?: &quot;;
    getline(cin, newCard);</p>

    Hand myHand;
    //transform everything to lower case
    transform(sampleString.begin(), sampleString.end(), sampleString.begin(), ::tolower);
    transform(newCard.begin(), newCard.end(), newCard.begin(), ::tolower);
    vector&lt;string&gt; hand = tokenizeStrings(sampleString, &quot;,:&quot;, 1);</p>

    // For each of the cards, we need to create cards out of them
    for (vector&lt;string&gt;::iterator _card = hand.begin(); _card != hand.end(); _card++)
        myHand.AddCard(new Card(*_card));
    myHand.sortHand();</p>

    Card* swappableCard = new Card(newCard);</p>

    cout &lt;&lt; &quot;Checking for a run with length &quot; &lt;&lt; RunLength &lt;&lt; &quot;\n&quot;;
    Card* swappedCard = myHand.CheckForRun(*swappableCard);
    outputWin(swappedCard);</p>

    cout &lt;&lt; &quot;Checking for a set with length &quot; &lt;&lt; SetLength &lt;&lt; &quot;\n&quot;;
    swappedCard = myHand.CheckForSet(*swappableCard);
    outputWin(swappedCard);</p>

    RunLength = 4;
    cout &lt;&lt; &quot;Checking for a run with length &quot; &lt;&lt; RunLength &lt;&lt; &quot;\n&quot;;
    swappedCard = myHand.CheckForRun(*swappableCard);
    outputWin(swappedCard);</p>

    SetLength = 4;
    cout &lt;&lt; &quot;Checking for a set with length &quot; &lt;&lt; SetLength &lt;&lt; &quot;\n&quot;;
    swappedCard = myHand.CheckForSet(*swappableCard);
    outputWin(swappedCard);</p>

    //Clean up
    delete swappableCard;
    myHand.cleanUp();</p>

    return 0;
}
[/code]</p>

Here's a sample of an input and output:</p>
<pre>What is the initial hand?: Two of Diamonds, Three of Diamonds, Four of Diamonds, Seven of Diamonds, Seven of Clubs, Seven of Hearts, Jack of Hearts
What is the added hand?: Five of Diamonds
Checking for a run with length 3
Swap the new card with seven of hearts to win!
Checking for a set with length 3
No possible winning hand.
Checking for a run with length 4
Swap the new card with seven of hearts to win!
Checking for a set with length 4
No possible winning hand.
</pre>

<span style="text-decoration:underline;"><strong>A brief explanation on the two checker methods</strong></span></p>

<em>Set Checker:</em>
Simply go through the hand and count the number of cards with the same value as the new card. If it exceeds 3 of 4, then you have a set. Then just go through the hand once more and swap with the first card that isn't the same value as the new card.</p>

<em>Run Checker:
</em>This code is significantly more messy. Let's see. Go through each card in the (sorted) hand until you get to the same suit as the new card. (Aside: the sort method that I've implemented, sorts the hands in terms of values grouped with their individual suits). Then, depending on if we're checking for a 3 card or 4 card run, we create a temporary second set called a Run (which is essentially a vector of cards).
We insert the new card in, and then insert the next 2 to 3 cards in depending on the length of the run we're interested in. When we're doing this, and we encounter a card with a different suit than our new card, we know that a run isn't possible since we've hit a new suit in a sorted hand, so break out of the function. If we are successful in adding the right number of cards, we sort this mini hand. Then we subtract the largest value from the smallest value, and the result should be the length of the run we are interested in minus 1. So for instance, if we are interested in a run of 4 cards, and we have 3, 4, 5, 6 of the same suit, then 6 - 3 would give us 3. Now if this is the case, then we have successfully found a run!
To find a card we can remove from the hand, I use the brute force method. Which means going through the hand once again and as soon as I hit a card which is not in the mini-hand, I can discard that card.
<em>Clearly this method can be improved upon....</em></p>

  </article>
  <div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'codebagelsandgibberish'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    
</div>
      </div>
    </div>

    <footer class="site-footer">

  <div class="wrap">

    <h2 class="footer-heading">Code, Bagels and Gibberish</h2>

    <div class="footer-col-1 column">
      <ul>
        <li>Code, Bagels and Gibberish</li>
        <li><a href="mailto:"></a></li>
      </ul>
    </div>

    <div class="footer-col-2 column">
      <ul>
        <li>
          <a href="https://github.com/healthycola">
            <span class="icon github">
              <svg version="1.1" class="github-icon-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                 viewBox="0 0 16 16" enable-background="new 0 0 16 16" xml:space="preserve">
                <path fill-rule="evenodd" clip-rule="evenodd" fill="#C2C2C2" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761
                c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32
                c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472
                c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037
                C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65
                c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261
                c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082
                c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129
                c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
              </svg>
            </span>
            <span class="username">healthycola</span>
          </a>
        </li>
        <li>
          <a href="https://twitter.com/healthycola">
            <span class="icon twitter">
              <svg version="1.1" class="twitter-icon-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                 viewBox="0 0 16 16" enable-background="new 0 0 16 16" xml:space="preserve">
                <path fill="#C2C2C2" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809
                c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27
                c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767
                c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206
                C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271
                c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469
                c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/>
              </svg>
            </span>
            <span class="username">healthycola</span>
          </a>
        </li>
      </ul>
    </div>

    <div class="footer-col-3 column">
      <p class="text">A small space for a newbie dev. Small and silly projects are always ongoing. Enjoy!</p>
    </div>

  </div>

</footer>


    </body>
</html>